<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8"/>
	<title>Meal Plan for Week</title>
	<link rel="stylesheet" href="/css/main.css"/>
	<script src="/js/jquery-3.2.1.min.js"></script>
	<script src="/js/js.cookie-2.1.4.js"></script>
</head>

<body id="body" style="display:none;">
    <h1>Meal Plan for Week</h1>
        
    <div id="week">
        <div id="monday" class="evenColumn">
            <span>Monday</span>
            <div class="daySchedule">
                <div class="mealEvent"><span>Breakfast</span></div>
                <div class="mealEvent"><span>Lunch</span></div>
                <div class="mealEvent"><span>Dinner</span></div>
            </div>
        </div>
        <div id="tuesday" class="oddColumn">
            <span>Tuesday</span>
            <div class="daySchedule">
                <div class="mealEvent"><span>Breakfast</span></div>
                <div class="mealEvent"><span>Lunch</span></div>
                <div class="mealEvent"><span>Dinner</span></div>
            </div>
        </div>
        <div id="wednesday" class="evenColumn">
            <span>Wednesday</span>
            <div class="daySchedule">
                <div class="mealEvent"><span>Breakfast</span></div>
                <div class="mealEvent"><span>Lunch</span></div>
                <div class="mealEvent"><span>Dinner</span></div>
            </div>
        </div>
        <div id="thursday" class="oddColumn">
            <span>Thursday</span>
            <div class="daySchedule">
                <div class="mealEvent"><span>Breakfast</span></div>
                <div class="mealEvent"><span>Lunch</span></div>
                <div class="mealEvent"><span>Dinner</span></div>
            </div>
        </div>
        <div id="friday" class="evenColumn">
            <span>Friday</span>
            <div class="daySchedule">
                <div class="mealEvent"><span>Breakfast</span></div>
                <div class="mealEvent"><span>Lunch</span></div>
                <div class="mealEvent"><span>Dinner</span></div>
            </div>
        </div>
        <div id="saturday" class="oddColumn">
            <span>Saturday</span>
            <div class="daySchedule">
                <div class="mealEvent"><span>Breakfast</span></div>
                <div class="mealEvent"><span>Lunch</span></div>
                <div class="mealEvent"><span>Dinner</span></div>
            </div>
        </div>
        <div id="sunday" class="evenColumn">
            <span>Sunday</span>
            <div class="daySchedule">
                <div class="mealEvent"><span>Breakfast</span></div>
                <div class="mealEvent"><span>Lunch</span></div>
                <div class="mealEvent"><span>Dinner</span></div>
            </div>
        </div>
    </div>
    
    <div id="signupAdvertisement" class="advertisement">
        <p>Do you want to use your own recipes?</p>
        <p><input id="signup" type="button" value="Signup to use your own recipes"/></p>
    </div>
    
    <div class="recipeSelectionArea">
        <div id="search">
            <div class="actions">
                <div>
                    <input id="newRecipe" type="button" value="New Recipe"/>
                    <script>
                        $('#newRecipe').click(function(){
                            $('#searchResultList').hide();
                            $('#recipeEditor').load('/snippets/recipeEditor.html');
                        });
                    </script>
                </div>
                <div>
                    <input id="searchTerm" type="text" placeholder="Search for an ingredient" size="40"/>
                    <input id="searchForRecipe" type="button" value="Search"/>
				    <script>
				        $('#searchForRecipe').click(function(){
				            $.ajax({
				                url: "/recipes/search?term=" + $('#searchTerm').val(),
				                method: "GET",
				                dataType: "json"
				            }).done(function(msg){
				                $('#searchResultList').empty();
				                if (msg.length == 0)
				                    $('#searchResultList').append('<LI>No recipes were found</LI>')
				                    
				                $.each(msg, function(index, value){
				                    $('#searchResultList').append('<div class="recipe"><div><img src="http://placehold.it/50x50"/></div><div><p class="">' + value['name'] + '</p><p class="description">' + value['description'] + '</p></div></div>');
				                });
				                
				                $('#searchTerm').val('');
				            });
				        });
				    </script>
                </div>
            </div>

            <ul id="searchResultList">
            </ul>
            
            <div id="recipeEditor"></div>

        </div>

		<div id="featuredRecipes"></div>
    </div>

    <script>
	    $(document).ready(function() {
	    	function disableMemberFunctions() {
				$('#signupAdvertisement').show() ;
        		$('#newRecipe').hide();
    	       	$('#body').show();

    	       	$('#featuredRecipes').load('/snippets/featuredRecipes.html');
	    	};
	    	
	    	function enableMemberFunctions() {
				$('#signupAdvertisement').hide() ;
		       	$('#body').show();

		       	$('#featuredRecipes').load('/snippets/personalRecipes.html');
	    	};
	    	
	       	$.ajax({
		        url: "/user",
		        method: "GET",
		        dataType: "json",
		        contentType: "application/json"
		    }).done(function(userInfo){
				if (userInfo['authenticated'] == false) {
					disableMemberFunctions();
				} else {
					enableMemberFunctions();
				}
		    })
		    .fail(function(userInfo, textStatus, errorThrown){
		    	disableMemberFunctions();
		    });
	    });
    </script>
</body>
</html>
 